From ff7aa7ef2b9ba41df8f2d1e71b05bf2c2ad868dd Mon Sep 17 00:00:00 2001
From: Vijay Sarvepalli <vssarvepalli@cert.org>
Date: Mon, 22 Dec 2025 12:24:27 -0500
Subject: [PATCH] Fix for CVE-2025-13151 Buffer overflow

Upstream-Status: Backport [https://gitlab.com/gnutls/libtasn1/-/commit/d276cc495a2a32b182c3c39851f1ba58f2d9f9b8]
CVE: CVE-2025-13151

Signed-off-by: Simon Josefsson <simon@josefsson.org>
Signed-off-by: Hugo SIMELIERE <hsimeliere.opensource@witekio.com>
---
 lib/decoding.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/decoding.c b/lib/decoding.c
index 1e0fcb3..abcb49f 100644
--- a/lib/decoding.c
+++ b/lib/decoding.c
@@ -1983,7 +1983,7 @@ int
 asn1_expand_octet_string (asn1_node_const definitions, asn1_node *element,
 			  const char *octetName, const char *objectName)
 {
-  char name[2 * ASN1_MAX_NAME_SIZE + 1], value[ASN1_MAX_NAME_SIZE];
+  char name[2 * ASN1_MAX_NAME_SIZE + 2], value[ASN1_MAX_NAME_SIZE];
   int retCode = ASN1_SUCCESS, result;
   int len, len2, len3;
   asn1_node_const p2;
-- 
2.47.1

