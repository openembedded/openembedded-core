From 44ca5b9d023e1de33fcb8984c85bb29619c4db7e Mon Sep 17 00:00:00 2001
From: Sebastian Rasmussen <sebras@gmail.com>
Date: Sun, 5 Nov 2023 12:21:52 +0100
Subject: [PATCH] Bug 705041: jbig2dec: Avoid uninitialized allocator in
 command-line tool.

This fixes CVE-2023-46361.

CVE: CVE-2023-46361

Upstream-Status: Backport [https://cgit.ghostscript.com/cgi-bin/cgit.cgi/ghostpdl.git/commit/?id=44ca5b9d023e1de33fcb8984c85bb29619c4db7e]

Signed-off-by: Archana Polampalli <archana.polampalli@windriver.com>
---
 jbig2dec/jbig2dec.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/jbig2dec/jbig2dec.c b/jbig2dec/jbig2dec.c
index dc1fd56..78c8e89 100644
--- a/jbig2dec/jbig2dec.c
+++ b/jbig2dec/jbig2dec.c
@@ -567,7 +567,7 @@ main(int argc, char **argv)
 {
     jbig2dec_params_t params;
     jbig2dec_error_callback_state_t error_callback_state;
-    jbig2dec_allocator_t allocator_;
+    jbig2dec_allocator_t allocator_ = { 0 };
     jbig2dec_allocator_t *allocator = &allocator_;
     Jbig2Ctx *ctx = NULL;
     FILE *f = NULL, *f_page = NULL;
--
2.40.0
