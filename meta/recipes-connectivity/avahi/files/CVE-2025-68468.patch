From 483f83828cfda965fac914ff1b39c63c256372b2 Mon Sep 17 00:00:00 2001
From: Hugo Muis <198191869+friendlyhugo@users.noreply.github.com>
Date: Sun, 2 Mar 2025 18:06:24 +0100
Subject: [PATCH] core: fix DoS bug by removing incorrect assertion

Closes https://github.com/avahi/avahi/issues/683

CVE: CVE-2025-68468

Upstream-Status: Backport
[https://github.com/avahi/avahi/commit/f66be13d7f31a3ef806d226bf8b67240179d309a]

Signed-off-by: Amaury Couderc <amaury.couderc@est.tech>
---
 avahi-core/browse.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/avahi-core/browse.c b/avahi-core/browse.c
index 86e4432..79595fe 100644
--- a/avahi-core/browse.c
+++ b/avahi-core/browse.c
@@ -295,7 +295,6 @@ static void lookup_multicast_callback(
                 lookup_drop_cname(l, interface, protocol, 0, r);
             else {
                 /* It's a normal record, so let's call the user callback */
-                assert(avahi_key_equal(b->key, l->key));
 
                 b->callback(b, interface, protocol, event, r, flags, b->userdata);
             }
-- 
2.43.0

